<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-segment/node_modules/segment/lib/Segment.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-segment">npmtest-segment (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-segment/node_modules/segment/lib/Segment.js</span></h1>
    <h2>
        
        Statements: <span class="metric">12.34% <small>(19 / 154)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 64)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 23)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">13.29% <small>(19 / 143)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-segment/node_modules/segment/lib/</a> &#187; Segment.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">'use strict';
&nbsp;
/**
 * 分词器接口
 *
 * @author 老雷&lt;leizongmin@gmail.com&gt;
 */
&nbsp;
var fs = require('fs');
var path = require('path');
var POSTAG = require('./POSTAG');
var Tokenizer = require('./Tokenizer');
var Optimizer = require('./Optimizer');
&nbsp;
var debug = console.log;
&nbsp;
&nbsp;
/**
 * 创建分词器接口
*/
var Segment = module.exports = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >  this.POSTAG = POSTAG; </span>// 词性
<span class="cstat-no" title="statement not covered" >  this.DICT = {}; </span>      // 词典表
<span class="cstat-no" title="statement not covered" >  this.modules = {</span>
    tokenizer:  [],     // 分词模块
    optimizer:  []      // 优化模块
  };
<span class="cstat-no" title="statement not covered" >  this.tokenizer = new Tokenizer(this);</span>
<span class="cstat-no" title="statement not covered" >  this.optimizer = new Optimizer(this);</span>
};
&nbsp;
/**
 * 载入分词模块
 *
 * @param {String|Array|Object} module 模块名称(数组)或模块对象
 * @return {Segment}
 */
Segment.prototype.use = <span class="fstat-no" title="function not covered" >function (module) {</span>
<span class="cstat-no" title="statement not covered" >  var me = this;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  if (Array.isArray(module)) {</span>
<span class="cstat-no" title="statement not covered" >    module.forEach(<span class="fstat-no" title="function not covered" >function (module) {</span></span>
<span class="cstat-no" title="statement not covered" >      me.use(module[i]);</span>
    });
&nbsp;
  } else {
<span class="cstat-no" title="statement not covered" >    if (typeof module == 'string') {</span>
<span class="cstat-no" title="statement not covered" >      var filename = path.resolve(__dirname, 'module', module + '.js');</span>
<span class="cstat-no" title="statement not covered" >      if (!fs.existsSync(filename)) {</span>
<span class="cstat-no" title="statement not covered" >        throw Error('Cannot find module "' + module + '".');</span>
      } else {
<span class="cstat-no" title="statement not covered" >        module = require(filename);</span>
      }
    }
    // 初始化并注册模块
<span class="cstat-no" title="statement not covered" >    module.init(this);</span>
<span class="cstat-no" title="statement not covered" >    this.modules[module.type].push(module);</span>
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  return this;</span>
};
&nbsp;
Segment.prototype._resolveDictFilename = <span class="fstat-no" title="function not covered" >function (name) {</span>
<span class="cstat-no" title="statement not covered" >  var filename = path.resolve(name);</span>
<span class="cstat-no" title="statement not covered" >  if (!fs.existsSync(filename)) {</span>
<span class="cstat-no" title="statement not covered" >    var filename = path.resolve(__dirname, '../dicts', name);</span>
<span class="cstat-no" title="statement not covered" >    if (!fs.existsSync(filename)) {</span>
<span class="cstat-no" title="statement not covered" >      throw Error('Cannot find dict file "' + filename + '".');</span>
    }
  }
<span class="cstat-no" title="statement not covered" >  return filename;</span>
};
&nbsp;
/**
 * 载入字典文件
 *
 * @param {String} name 字典文件名
 * @param {String} type 类型
 * @param {Boolean} convert_to_lower 是否全部转换为小写
 * @return {Segment}
 */
Segment.prototype.loadDict = <span class="fstat-no" title="function not covered" >function (name, type, convert_to_lower) {</span>
<span class="cstat-no" title="statement not covered" >  var filename = this._resolveDictFilename(name);</span>
<span class="cstat-no" title="statement not covered" >  if (!type)  <span class="cstat-no" title="statement not covered" >type = 'TABLE'; </span></span>    // 默认为TABLE
&nbsp;
  // 初始化词典
<span class="cstat-no" title="statement not covered" >  if (!this.DICT[type]) <span class="cstat-no" title="statement not covered" >this.DICT[type] = {};</span></span>
<span class="cstat-no" title="statement not covered" >  if (!this.DICT[type + '2']) <span class="cstat-no" title="statement not covered" >this.DICT[type + '2'] = {};</span></span>
<span class="cstat-no" title="statement not covered" >  var TABLE = this.DICT[type]; </span>       // 词典表  '词' =&gt; {属性}
<span class="cstat-no" title="statement not covered" >  var TABLE2 = this.DICT[type + '2']; </span>// 词典表  '长度' =&gt; '词' =&gt; 属性
  // 导入数据
<span class="cstat-no" title="statement not covered" >  var POSTAG = this.POSTAG;</span>
<span class="cstat-no" title="statement not covered" >  var data = fs.readFileSync(filename, 'utf8');</span>
<span class="cstat-no" title="statement not covered" >  if (convert_to_lower) <span class="cstat-no" title="statement not covered" >data = data.toLowerCase();</span></span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  data.split(/\r?\n/).forEach(<span class="fstat-no" title="function not covered" >function (line) {</span></span>
<span class="cstat-no" title="statement not covered" >    var blocks = line.split('|');</span>
<span class="cstat-no" title="statement not covered" >    if (blocks.length &gt; 2) {</span>
<span class="cstat-no" title="statement not covered" >      var w = blocks[0].trim();</span>
<span class="cstat-no" title="statement not covered" >      var p = Number(blocks[1]);</span>
<span class="cstat-no" title="statement not covered" >      var f = Number(blocks[2]);</span>
&nbsp;
      // 一定要检查单词是否为空，如果为空会导致Bug
<span class="cstat-no" title="statement not covered" >      if (w.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >        TABLE[w] = {f: f, p: p};</span>
<span class="cstat-no" title="statement not covered" >        if (!TABLE2[w.length]) <span class="cstat-no" title="statement not covered" >TABLE2[w.length] = {};</span></span>
<span class="cstat-no" title="statement not covered" >        TABLE2[w.length][w] = TABLE[w];</span>
      }
    }
  });
&nbsp;
<span class="cstat-no" title="statement not covered" >  return this;</span>
};
&nbsp;
/**
 * 取词典表
 *
 * @param {String} type 类型
 * @return {object}
 */
Segment.prototype.getDict = <span class="fstat-no" title="function not covered" >function (type) {</span>
<span class="cstat-no" title="statement not covered" >  return this.DICT[type];</span>
};
&nbsp;
/**
 * 载入同义词词典
 *
 * @param {String} name 字典文件名
 */
Segment.prototype.loadSynonymDict = <span class="fstat-no" title="function not covered" >function (name) {</span>
<span class="cstat-no" title="statement not covered" >  var filename = this._resolveDictFilename(name);</span>
<span class="cstat-no" title="statement not covered" >  var type = 'SYNONYM';</span>
&nbsp;
  // 初始化词典
<span class="cstat-no" title="statement not covered" >  if (!this.DICT[type]) <span class="cstat-no" title="statement not covered" >this.DICT[type] = {};</span></span>
<span class="cstat-no" title="statement not covered" >  var TABLE = this.DICT[type]; </span>       // 词典表  '同义词' =&gt; '标准词'
  // 导入数据
<span class="cstat-no" title="statement not covered" >  var data = fs.readFileSync(filename, 'utf8');</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  data.split(/\r?\n/).forEach(<span class="fstat-no" title="function not covered" >function (line) {</span></span>
<span class="cstat-no" title="statement not covered" >    var blocks = line.split(',');</span>
<span class="cstat-no" title="statement not covered" >    if (blocks.length &gt; 1) {</span>
<span class="cstat-no" title="statement not covered" >      var n1 = blocks[0].trim();</span>
<span class="cstat-no" title="statement not covered" >      var n2 = blocks[1].trim();</span>
<span class="cstat-no" title="statement not covered" >      TABLE[n1] = n2;</span>
<span class="cstat-no" title="statement not covered" >      if (TABLE[n2] === n1) {</span>
<span class="cstat-no" title="statement not covered" >        delete TABLE[n2];</span>
      }
    }
  });
&nbsp;
<span class="cstat-no" title="statement not covered" >  return this;</span>
};
&nbsp;
/**
 * 载入停止符词典
 *
 * @param {String} name 字典文件名
 */
Segment.prototype.loadStopwordDict = <span class="fstat-no" title="function not covered" >function (name) {</span>
<span class="cstat-no" title="statement not covered" >  var filename = this._resolveDictFilename(name);</span>
<span class="cstat-no" title="statement not covered" >  var type = 'STOPWORD';</span>
&nbsp;
  // 初始化词典
<span class="cstat-no" title="statement not covered" >  if (!this.DICT[type]) <span class="cstat-no" title="statement not covered" >this.DICT[type] = {};</span></span>
<span class="cstat-no" title="statement not covered" >  var TABLE = this.DICT[type]; </span>       // 词典表  '同义词' =&gt; '标准词'
  // 导入数据
<span class="cstat-no" title="statement not covered" >  var data = fs.readFileSync(filename, 'utf8');</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  data.split(/\r?\n/).forEach(<span class="fstat-no" title="function not covered" >function (line) {</span></span>
<span class="cstat-no" title="statement not covered" >    line = line.trim();</span>
<span class="cstat-no" title="statement not covered" >    if (line) {</span>
<span class="cstat-no" title="statement not covered" >      TABLE[line] = true;</span>
    }
  });
&nbsp;
<span class="cstat-no" title="statement not covered" >  return this;</span>
};
&nbsp;
/**
 * 使用默认的识别模块和字典文件
 *
 * @return {Segment}
 */
Segment.prototype.useDefault = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >  this</span>
    // 识别模块
    // 强制分割类单词识别
    .use('URLTokenizer')            // URL识别
    .use('WildcardTokenizer')       // 通配符，必须在标点符号识别之前
    .use('PunctuationTokenizer')    // 标点符号识别
    .use('ForeignTokenizer')        // 外文字符、数字识别，必须在标点符号识别之后
    // 中文单词识别
    .use('DictTokenizer')           // 词典识别
    .use('ChsNameTokenizer')        // 人名识别，建议在词典识别之后
&nbsp;
    // 优化模块
    .use('EmailOptimizer')          // 邮箱地址识别
    .use('ChsNameOptimizer')        // 人名识别优化
    .use('DictOptimizer')           // 词典识别优化
    .use('DatetimeOptimizer')       // 日期时间识别优化
&nbsp;
    // 字典文件
    .loadDict('dict.txt')           // 盘古词典
    .loadDict('dict2.txt')          // 扩展词典（用于调整原盘古词典）
    .loadDict('dict3.txt')          // 扩展词典（用于调整原盘古词典）
    .loadDict('names.txt')          // 常见名词、人名
    .loadDict('wildcard.txt', 'WILDCARD', true)   // 通配符
    .loadSynonymDict('synonym.txt')   // 同义词
    .loadStopwordDict('stopword.txt') // 停止符
  ;
<span class="cstat-no" title="statement not covered" >  return this;</span>
};
&nbsp;
/**
 * 开始分词
 *
 * @param {String} text 文本
 * @param {Object} options 选项
 *   - {Boolean} simple 是否仅返回单词内容
 *   - {Boolean} stripPunctuation 去除标点符号
 *   - {Boolean} convertSynonym 转换同义词
 *   - {Boolean} stripStopword 去除停止符
 * @return {Array}
 */
Segment.prototype.doSegment = <span class="fstat-no" title="function not covered" >function (text, options) {</span>
<span class="cstat-no" title="statement not covered" >  var me = this;</span>
<span class="cstat-no" title="statement not covered" >  options = options || {};</span>
<span class="cstat-no" title="statement not covered" >  var ret = [];</span>
&nbsp;
  // 将文本按照换行符分割成多段，并逐一分词
<span class="cstat-no" title="statement not covered" >  text.replace(/\r/g, '\n').split(/(\n|\s)+/).forEach(<span class="fstat-no" title="function not covered" >function (section) {</span></span>
<span class="cstat-no" title="statement not covered" >    var section = section.trim();</span>
<span class="cstat-no" title="statement not covered" >    if (section.length &lt; 1) <span class="cstat-no" title="statement not covered" >return;</span></span>
    // ======================================
    // 分词
<span class="cstat-no" title="statement not covered" >    var sret = me.tokenizer.split(section, me.modules.tokenizer);</span>
&nbsp;
    // 优化
<span class="cstat-no" title="statement not covered" >    sret = me.optimizer.doOptimize(sret, me.modules.optimizer);</span>
&nbsp;
    // ======================================
    // 连接分词结果
<span class="cstat-no" title="statement not covered" >    if (sret.length &gt; 0) <span class="cstat-no" title="statement not covered" >ret = ret.concat(sret);</span></span>
  });
&nbsp;
  // 去除标点符号
<span class="cstat-no" title="statement not covered" >  if (options.stripPunctuation) {</span>
<span class="cstat-no" title="statement not covered" >    ret = ret.filter(<span class="fstat-no" title="function not covered" >function (item) {</span></span>
<span class="cstat-no" title="statement not covered" >      return item.p !== POSTAG.D_W;</span>
    });
  }
&nbsp;
  // 转换同义词
<span class="fstat-no" title="function not covered" >  function convertSynonym (list) {</span>
<span class="cstat-no" title="statement not covered" >    var count = 0;</span>
<span class="cstat-no" title="statement not covered" >    var TABLE = me.getDict('SYNONYM');</span>
<span class="cstat-no" title="statement not covered" >    list = list.map(<span class="fstat-no" title="function not covered" >function (item) {</span></span>
<span class="cstat-no" title="statement not covered" >      if (item.w in TABLE) {</span>
<span class="cstat-no" title="statement not covered" >        count++;</span>
<span class="cstat-no" title="statement not covered" >        return {w: TABLE[item.w], p: item.p};</span>
      } else {
<span class="cstat-no" title="statement not covered" >        return item;</span>
      }
    });
<span class="cstat-no" title="statement not covered" >    return {count: count, list: list};</span>
  }
<span class="cstat-no" title="statement not covered" >  if (options.convertSynonym) {</span>
<span class="cstat-no" title="statement not covered" >    do {</span>
<span class="cstat-no" title="statement not covered" >      var result = convertSynonym(ret);</span>
<span class="cstat-no" title="statement not covered" >      ret = result.list;</span>
    } while (result.count &gt; 0);
  }
&nbsp;
  // 去除停止符
<span class="cstat-no" title="statement not covered" >  if (options.stripStopword) {</span>
<span class="cstat-no" title="statement not covered" >    var STOPWORD = me.getDict('STOPWORD');</span>
<span class="cstat-no" title="statement not covered" >    ret = ret.filter(<span class="fstat-no" title="function not covered" >function (item) {</span></span>
<span class="cstat-no" title="statement not covered" >      return !(item.w in STOPWORD);</span>
    });
  }
&nbsp;
  // 仅返回单词内容
<span class="cstat-no" title="statement not covered" >  if (options.simple) {</span>
<span class="cstat-no" title="statement not covered" >    ret = ret.map(<span class="fstat-no" title="function not covered" >function (item) {</span></span>
<span class="cstat-no" title="statement not covered" >      return item.w;</span>
    });
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  return ret;</span>
};
&nbsp;
/**
 * 将单词数组连接成字符串
 *
 * @param {Array} words 单词数组
 * @return {String}
 */
Segment.prototype.toString= <span class="fstat-no" title="function not covered" >function (words) {</span>
<span class="cstat-no" title="statement not covered" >  return words.map(<span class="fstat-no" title="function not covered" >function (item) {</span></span>
<span class="cstat-no" title="statement not covered" >    return item.w;</span>
  }).join('');
};
&nbsp;
/**
 * 根据某个单词或词性来分割单词数组
 *
 * @param {Array} words 单词数组
 * @param {Number|String} s 用于分割的单词或词性
 * @return {Array}
 */
Segment.prototype.split = <span class="fstat-no" title="function not covered" >function (words, s) {</span>
<span class="cstat-no" title="statement not covered" >  var ret = [];</span>
<span class="cstat-no" title="statement not covered" >  var lasti = 0;</span>
<span class="cstat-no" title="statement not covered" >  var i = 0;</span>
<span class="cstat-no" title="statement not covered" >  var f = typeof s === 'string' ? 'w' : 'p';</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  while (i &lt; words.length) {</span>
<span class="cstat-no" title="statement not covered" >    if (words[i][f] == s) {</span>
<span class="cstat-no" title="statement not covered" >      if (lasti &lt; i) <span class="cstat-no" title="statement not covered" >ret.push(words.slice(lasti, i));</span></span>
<span class="cstat-no" title="statement not covered" >      ret.push(words.slice(i, i + 1));</span>
<span class="cstat-no" title="statement not covered" >      i++;</span>
<span class="cstat-no" title="statement not covered" >      lasti = i;</span>
    } else {
<span class="cstat-no" title="statement not covered" >      i++;</span>
    }
  }
<span class="cstat-no" title="statement not covered" >  if (lasti &lt; words.length - 1) {</span>
<span class="cstat-no" title="statement not covered" >    ret.push(words.slice(lasti, words.length));</span>
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  return ret;</span>
};
&nbsp;
/**
 * 在单词数组中查找某一个单词或词性所在的位置
 *
 * @param {Array} words 单词数组
 * @param {Number|String} s 要查找的单词或词性
 * @param {Number} cur 开始位置
 * @return {Number} 找不到，返回-1
 */
Segment.prototype.indexOf = <span class="fstat-no" title="function not covered" >function (words, s, cur) {</span>
<span class="cstat-no" title="statement not covered" >  cur = isNaN(cur) ? 0 : cur;</span>
<span class="cstat-no" title="statement not covered" >  var f = typeof s === 'string' ? 'w' : 'p';</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  while (cur &lt; words.length) {</span>
<span class="cstat-no" title="statement not covered" >    if (words[cur][f] == s) <span class="cstat-no" title="statement not covered" >return cur;</span></span>
<span class="cstat-no" title="statement not covered" >    cur++;</span>
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  return -1;</span>
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Sat Apr 22 2017 16:28:12 GMT+0000 (UTC)</div>
</div>
</body>
</html>
